{% extends "whitecity/views/templates/market.html" %}
{% block content %}
<div id="market">
  <div class="row">
    <nav class="categories cell">
      <div class="legend">Shop by <strong>Category</strong></div>
      {{categories|render-tree}}
    </nav>
    <div class="ls cell">
      <div class="options">
        <form method="get">
          <span class="well">
            <label>
              sort by:
              <select name="sort_by">
                <option value="bestselling">bestselling</option>
                <option value="lowest">lowest price</option>
                <option value="highest">highest price</option>
                <option value="title">title</option>
                <option value="newest">newest</option>
              </select>
            </label>
            <label>
              <input type="checkbox" name="ships_to" value="true"> ships to my region
            </label>
            <label>
              <input type="checkbox" name="ships_from" value="true"> ships from my region
            </label>
          </span>
          <button type="submit" class="btn">update</button>
        </form>

      </div>
      {% for listing in listings %}
      <div class="listing-row">
        {% if listing.image_id %}
        <div class="thumbnail">
          {% image-thumbnail listing.image_id %}
        </div>
        {% endif %}
        <div class="sale">
          <div class="text">
            <span>{{listing.price|double-format:5}}</span>
            <br />
            <a href="/market/cart/add/{{listing.id}}">add to cart</a>
          </div>
        </div>
        <h1><a href="/market/listing/{{listing.id}}">{{listing.title}}</a></h1>
        <ul>
          <li>seller: <a href="/market/user/{{listing.user_id}}">{{listing.alias}}</a></li>
          <li>ships from: {{listing.from|default-if-empty:"Undeclared"}}</li>
          {% if not listing.to|empty? %}
          <li>ships to: {{listing.to}}</li>
          {% endif %}
        </ul>
      </div>
      {% endfor %}
      <div class="clear-float"></div>
      <div class="market">{{page|pagination}}</div>
    </div>
  </div>
</div>
{% endblock %}
