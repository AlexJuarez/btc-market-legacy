{% extends "whitecity/views/templates/market.html" %}
{% block content %}
<form action="/market/listing/{{id}}/edit" enctype="multipart/form-data" method="POST">
  {% csrf-token %}
  <div class="image">
  {% if image_id %}
    <img src="/uploads/{{image_id}}.jpg" />
  {% else %}
    300<em>px</em> x <em>400px</em>
  {% endif %}
  </div>
  <div class="top form-group {% if errors.title %}has-error{% endif %}">
    <label for="title">Title:
    {% if errors.title %}
      {{errors.title|join:", "}}
    {% endif %}
    </label>
    <input name="title" id="title" class="form-control" type="text" value="{{title}}" />
  </div>
  <div class="form-group top public">
      <label>Public?</label>
      <div> 
        <input type="checkbox" {% if public %}checked{% endif %} name="public" value="true">
        (check for yes)
      </div>
  </div>
  <div class="top well">
    <div class="form-group">
      <label>Upload a Image (.jpg):</label>
      <div>
        <input type="file" name="image" accept="image/jpeg" />
      </div>
    </div>
    {% if images %}
    <div class="form-group">
      <label for="images">Select an image:</label>
      <div> 
        <select id="images" name="image_id">
        <option value {% if not image_id %}selected="selected"{% endif %}>None</option>
        {% for image in images %}
        <option {% ifequal image_id image.id %}selected="selected"{% endifequal %} value="{{image.id}}">
        {% if image.name %}
        {{image.name}}
        {% else %}
        {{image.id}}
        {% endif %}
        </option>
        {% endfor %}
        </select>
        <a href="/market/images">manage images</a>
      </div>
    </div>
    {% endif %}
  </div>
  <div class="form-group">
    <label for="category_id">Category: </label>
    <div>
      <select id="category_id" name="category_id">
        {% for category in categories %}
        <option value="{{category.id}}">{{category.name}}</option>
        {% endfor %}
      </select>
    </div>
  </div>
  <div class="form-group {% if errors.title %}has-error{% endif %}">
    <label for="price">
    <select title="currency" name="currency_id" id="currency_id">
      {% for curr in currencies %}
      <option value="{{curr.id}}" {% ifequal curr.id currency_id %}selected="selected"{% endifequal %}>{{curr.name}}</option>
      {% endfor %}
    </select>
    {% if errors.currency_id %}
    {{errors.currency_id|join:", "}}
    {% endif %}
    Price: 
    {% if errors.price  %}
    {{errors.price|join:", "}}
    {% endif %}
    </label>
    <div>
      <input name="price" id="price" class="form-control" type="text" value="{{price}}" />
    </div>
  </div>
  <div class="form-group {% if errors.quantity %}has-error{% endif %}">
    <label for="quantity">Quantity:
      {% if errors.quantity %}
        {{errors.quantity|join:", "}}
      {% endif %}
    </label>
    <input class="form-control" name="quantity" value="{{quantity}}" id="quantity" />
  </div>
  <div class="form-group">
    <label for="ships_from">Ships from:</label>
    <input class="form-control" name="from" value="{{from}}" id="ships_from" />
  </div>
  <div class="form-group">
    <label for="ships_to">Ships to:</label>
    <input class="form-control" name="to" value="{{to}}" id="ships_to" />
  </div>
  <div class="form-group">
    <label for="description">Description:</label>
    <textarea id="description" class="form-control" rows="4" name="description">{{description}}</textarea>
  </div>
  <div class="form-group">
    <button type="submit" class="btn">update</button>
  </div>
</form>
{% endblock %}
