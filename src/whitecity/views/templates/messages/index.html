{% extends "whitecity/views/templates/market.html" %}
{% block content %}
<div class="inbox">
  <h1 class="jumbo">my messages</h1>
  <nav class="nav"><em><a href="/messages">inbox <strong>{{user.messages.unread}}</strong></a></em> - <a href="/messages/sent">sent</a></nav>
</div>
{% if not messages|empty? %}
<table class="table normal messages">
  <thead>
    <tr>
      <th>from</th>
      <th>subject</th>
      <th>freshness</th>
      <th>&nbsp;</th>
    </tr>
  </thead>
  <tfoot>
  <tr>
    <td colspan="4">
      {{page|pagination}}
    </td>
  </tr>
  </tfoot>
  <tbody>
  {% for message in messages %}
    <tr class="message">
      <td>
        <span class="sender">{{message.user_alias}}</span>
      </td>
      <td>{% if message.subject %}{{message.subject}}{% else %}no subject{% endif %}</td>
      <td><span title="{{message.created_on|date:fullDateTime}}" class="age pretty-time">{{message.created_on|date:shortDate}}</span></td>
      <td>
        {% if message.read %}
        <span class="subject"><a href="/messages/{{message.sender_id}}">read</a></span>
        {% else %}
        <span class="subject">
          <strong><a href="/messages/{{message.sender_id}}">read</a></strong>
        </span>
        {% endif %}
         | <a href="/message/{{message.id}}/delete">delete</a>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% else %}
<div class="well">You do not have any messages</div>
{% endif %}
{% if not news|empty? %}
<h2>News from followed vendors</h2>
<table class="table normal messages">
  <thead>
  <tr>
    <th>from</th>
    <th>subject</th>
    <th>freshness</th>
    <th>&nbsp;</th>
  </tr>
  </thead>
  <tbody>
  {% for article in news %}
  <tr class="message">
    <td>
      <a href="/user/{{article.alias}}">{{article.alias}}</a>
    </td>
    <td><a href="/news/{{article.id}}">{{article.subject}}</a></td>
    <td><span title="{{article.created_on|date:fullDateTime}}" class="age pretty-time">{{article.created_on|freshness}}</span></td>
    <td><a href="/news/{{article.id}}">read</a></td>
  </tr>
  {% endfor %}
  </tbody>
</table>
{% endif %}
{% endblock %}
